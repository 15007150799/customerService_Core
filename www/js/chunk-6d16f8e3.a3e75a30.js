(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d16f8e3"],{"1a9a":function(t,e,s){"use strict";var a=s("d77c"),i=s.n(a);i.a},"6bcd":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAIAAAC2BqGFAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEFFRjVFNzlEMTFEMTFFODk2QzNERTdFQzYyMTRBMDMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEFFRjVFN0FEMTFEMTFFODk2QzNERTdFQzYyMTRBMDMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4QUVGNUU3N0QxMUQxMUU4OTZDM0RFN0VDNjIxNEEwMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4QUVGNUU3OEQxMUQxMUU4OTZDM0RFN0VDNjIxNEEwMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkCoJKYAAAVdSURBVHja7J3rcqJAEIURJybGy8+8/6vlFZSIctE9xSmntozZgDbasOf8YNmUTA0fTU9Pz4XJ5+dnXddpmiZSDzoej9Pp9OPjI9SNTqeToPQEGkfgDbBl/COL7k9gO5lMxPdRuIVAoAVaEmiBFmhJoAVaEmiBFmhJoAVaEmiBFmhJoAVa6qgwiFpy7PjUKP5xcpZAG+h4PJLm9Cyck3hVVRy/J33nxL2DThuFEF5fX9/e3mazGViDPijv9/vD4UDcHNUX6FsMGceXl5e3RqEREHNaBI44x1/e399BuSiKPM8B3fNMII+g4QrAkSY8n89x8v03cBQAzXOYOR4JDBy4y7IU6LYCRCBer9c4tvG8eCowbfwYJ9vtFs4Ej8qby0692TIAwYpXqxUMuRMsOI3lcokLgVtx9O+2DD8AWGB9g7cF4sViAeuGV/E2mzB1Zc5wtXQCN7/4eDxgjacl0L+DvidywLVsG+Wjf26Xm2AZjO4PvclaoK+3gbNGJgXCWaMo9iEF+rIZZPfasD/pyns4ch2k462osbmO5JyNM3xFYskCfQnFiovDlJ6j9+vYyAq0t3yeF9BEY2jRhqWN0KKt0KCouq5l0f9qEscqXz1Dq5iMwwICfZ0yk0EmpTFn4oq1l/AOtgw6hh0WlBZHcgW6Rx+tNOm/+hfmZfoZ03IE2raL4S2U9tVhcf6WjAE0rc8QjbdeuCOL3u/3RVGYlIZyUJori3YRabK9yvOcs+vujH+rqvr6+trtdomyd99Bw/rqugbrLMvuSVPAXYAyyuH8R4G+zgiv/OFwuMe34lqUgHKUJv3Fru/MSse9uDTd4HfQ97gOTuEV6Fak8OKjQbutGcS13jLRHkHTqG+O82JU53D2v1PQaNC6RsH4Pa4S6G6RA3ghEG7fKjKqw1Vu11h4BA17hBMAuPbeFnzxYHCV2yVDftcZjmwI0S/ooSwgHAPoTqydPxgtUf6PQd824BLHrgS6bQM4nU5fGrX3BvglL/G5JCtxtc6Q9sjJ+u+N2lPDL5fLZQghz3NE0zEu9OO4gwe40Ypnf6mrbXJaCI7z+bxoVDWCC/Iw+z88ETHnzXBRBcjGZfU3l8kBGhTCMQRmt8uy9OC7w+P5xhMaIJfVg6+h3XHRMsQ0EwTcFxnBB9t4eAxcbrtBi+O2ELHFg/Bf89vm7DLujIBj2Yh7TtCfcHzgYV4lPMA/kC+Bcuw18n3EHTaiPyFrHHnOrRAeM1DQO2gur+SGENFyn9I08WViG8ANbBiicJRyqKDjPgVwlGjlaFauuvWx5QTo3W7HDHh/uEN/5oN7QGwL1m6zEHz8XBedZVmv6ey+QMOQ1+u1w8XvV82cbm2z2QD3MLrgjN5AebVacTX2IDI+cZ8Q1DzpJxWe2lKONb66EZJzoc7RPsxZG4OGr1gsFt62cOjUj2f9XYNmCs3bKp2uzSPq30fTktrW0mRnk6cbNeNRj6DpnVE/q/VrzxUzXLaeOjWv3whA92ExZqBtFwo+V33cS2riN5iQG24b+FOnkd+J9QV6NOZ8YdSOQCfnHdBGBtr2jmwsmmNR4wON+3Jn0YPIH3XNfviy6OS8a10yLtmOcpl1WJLRyXbsPDUx57Ist9ut/4322wv3kmUZ7svKqIMJ6KqqADppRp1H0CRyyQE3V/cFGq9YURSbzQbHAeX7f/IYnA3CMXJHoGP9UDPawtBBx1kfhjdiBpp14ocMRhDbmX+zKPRRxUTqKbyTBFqgBVoSaIGWBFqgBVoSaIGWBFqgBVoSaIGWBFqgBVoyVzD8uJ30XVxlfjqdAufMjWkiqCvFb+lO8jz3uWvqOBQXuf4RYAAUm23aIoRT8QAAAABJRU5ErkJggg=="},"75f8":function(t,e,s){},"9d64":function(t,e,s){t.exports=s.p+"img/logo.2990616a.png"},"9fbe":function(t,e,s){},a56d:function(t,e,s){"use strict";var a=s("9fbe"),i=s.n(a);i.a},bb51:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ChatWindow"},[s("div",{staticClass:"ChatHead"},[s("ul",{staticClass:"ChatHead_lt"},[s("li",{class:["ReplyPanel"===t.currentTab?"ChatHeadCur":""],on:{click:function(e){t.currentTab="ReplyPanel"}}},[s("span",{staticClass:"access"},[t._v("\n                    待回复\n                    "),t.replyNum>0?s("em",[t._v(t._s(t.replyNum))]):t._e()])]),s("li",{class:["AccessPanel"===t.currentTab?"ChatHeadCur":""],on:{click:function(e){t.currentTab="AccessPanel"}}},[s("span",{staticClass:"access"},[t._v("\n                    待接入\n                    "),t.accessNum>0?s("em",[t._v(t._s(t.accessNum))]):t._e()])]),s("li",{class:["StatisticsPanel"===t.currentTab?"ChatHeadCur":""],on:{click:function(e){t.currentTab="StatisticsPanel"}}},[s("span",{staticClass:"access"},[t._v("\n                    统计数据\n                ")])])]),s("div",{staticClass:"ChatHead_rt"},[s("p",{staticClass:"ChatHead_btn"},[s("a",{staticClass:"OffLineBtn",attrs:{href:"javascript:"},on:{click:t.loginOut}},[t._v("退出")])])])]),s("div",{staticClass:"ChatWindowMain"},[s("div",{staticClass:"ChatWrap clear"},[s("keep-alive",[s(t.currentTabComputed,{tag:"component"})],1)],1)]),s("div",{staticClass:"ChatHead_status"},[s("div",{class:["ChatHead_status_icon",t.isOnline?"ChatHead_status_icon_green":"ChatHead_status_icon_red"]}),s("span",[t._v(t._s(t.isOnline?"在线":"离线"))])])])},i=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ChatWrapItem",staticStyle:{display:"block"},attrs:{id:"ChatWrapReply"}},[a("div",{staticClass:"ContactsList"},[t.ContactsItems.length<1?a("el-row",{staticClass:"none_prompt"},[t._v("\n            ~~空空如也~~\n        ")]):a("ul",{staticClass:"ContactsList_ul",attrs:{id:"dialogList"}},t._l(t.ContactsItems,function(e){return a("li",{class:[t.CustomerId===e.room_customer.customer_id?"dialog_select":""],attrs:{type:e.room_customer.customer_id},on:{click:function(s){return t.openChatBody(e.room_customer)}}},[a("dl",{staticClass:"ContactsDl"},[a("dt",[e.room_customer.customer_head_img_url?a("img",{staticClass:"ContactsImg",attrs:{src:e.room_customer.customer_head_img_url,alt:e.room_customer.customer_nick_name}}):a("img",{staticClass:"ContactsImg",attrs:{src:s("6bcd"),alt:"暂无头像"}})]),a("dd",[a("span",{staticClass:"ContactsName"},[t._v("\n                        "+t._s(e.room_customer.customer_nick_name)+"\n                        ")]),a("div",{staticClass:"ChatCon"},[t._v("\n                            "+t._s(e.room_messages[e.room_messages.length-1].msg)+"\n                        ")])])]),a("p",{staticClass:"ChatTime"},[t._v("\n                    "+t._s(e.room_messages[e.room_messages.length-1].create_time.substring(0,19).replace("T"," "))+"\n                ")]),2002===e.room_messages[e.room_messages.length-1].oper_code&&!1===e.room_messages[e.room_messages.length-1].ack?a("em",{staticClass:"UnreadEm"},[t._v("\n                    未读\n                ")]):t._e()])}),0)],1),a("ChatBody",{ref:"chatB"})],1)},o=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.customerId?a("div",{staticClass:"ChatWindowCon",attrs:{id:"ChatWindowCon"}},[a("h2",{staticClass:"ChatName"},[t._v("\n            "+t._s(t.customerName)+"\n            "),a("span",[t._v("ID: "+t._s(t.customerId))])]),a("ul",{staticClass:"ChatWindowDiv",attrs:{id:"ChatWindow"}},t._l(t.ContactItem,function(e){return a("li",{class:[2003===e.oper_code?"MeCon":"FriendsCon"],attrs:{ids:e.id}},[a("p",{staticClass:"ChatWindowTime"},[t._v(t._s(e.create_time.substring(0,19).replace("T"," ")))]),a("div",{staticClass:"ChatWindowIn"},[2003===e.oper_code?a("img",{staticClass:"touxiang",attrs:{src:s("9d64"),alt:"img"}}):a("img",{staticClass:"touxiang",attrs:{src:t.customerImg?t.customerImg:"../assets/images/default.png",alt:"img"}}),a("div",{staticClass:"ChatWindowText",domProps:{innerHTML:t._s(e.msg.replace(/\n/g,"<br>"))}})])])}),0),a("div",{staticClass:"InputBox clear"},[a("div",{staticClass:"InputBoxIcon"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"将此用户转接给其他客服",placement:"top"}},[a("el-popover",{attrs:{placement:"right",width:"300",trigger:"click"},on:{show:t.TransferShow,"after-leave":function(e){t.TransferValue=""}},model:{value:t.TransferPopover,callback:function(e){t.TransferPopover=e},expression:"TransferPopover"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.TransferValue,callback:function(e){t.TransferValue=e},expression:"TransferValue"}},t._l(t.TransferOptions,function(e){return a("el-option-group",{key:e.label,attrs:{label:e.label}},t._l(e.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)}),1),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"mini"},on:{click:t.Transfer}},[t._v("\n                            确定转接\n                        ")]),a("i",{staticClass:"el-icon-share icon_Upload",attrs:{slot:"reference"},slot:"reference"})],1)],1)],1),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.Msg,expression:"Msg"}],staticClass:"textarea",attrs:{placeholder:"请输入内容\n按Enter发送 Ctrl+Enter换行"},domProps:{value:t.Msg},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),t.sendMesage(e))},input:function(e){e.target.composing||(t.Msg=e.target.value)}}})]),a("div",{staticClass:"rightCon"},[a("div",{staticClass:"ChatOffLineDiv"},[a("el-tabs",{model:{value:t.ActiveName,callback:function(e){t.ActiveName=e},expression:"ActiveName"}},[a("el-tab-pane",{attrs:{label:"智能回复",name:"SmartReply"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-date"}),t._v(" 智能回复")]),t.AnswerText?a("div",{staticClass:"ChatOffLineHide"},[a("div",{staticClass:"ChatOffLineDivCon"},[a("div",{staticClass:"ChatOffLineDivConWen"},[a("span",[t._v("问：")]),a("p",{staticClass:"AnswerTitle",domProps:{innerHTML:t._s(t.AnswerTitle.replace(/\n/g,"<br >"))}})]),a("div",{staticClass:"ChatOffLineDivConWen"},[a("span",[t._v("答：")]),a("pre",{staticClass:"AnswerText",domProps:{innerHTML:t._s(t.AnswerText.replace(/\n/g,"<br >"))}},[t._v("                                    ")])])]),a("div",{staticClass:"ChatOffLineInput"},[a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(e){t.Msg=t.AnswerText}}},[t._v("将回答放入输入框\n                                ")])],1)]):a("div",{staticStyle:{"text-align":"center"}},[a("small",[t._v("小金机器人未侦测到可回复问题")])])]),a("el-tab-pane",{attrs:{label:"用户画像",name:"UserPortrait"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-picture"}),t._v(" 用户画像")]),a("div",{staticStyle:{"text-align":"center"}},[a("small",[t._v("程序猿小哥哥加紧开发中...")])])])],1)],1)])]):t._e()},l=[];function c(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));let s={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(let a in s)if(new RegExp(`(${a})`).test(e)){let t=s[a]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?t:m(t))}return e}function m(t){return("00"+t).substr(t.length)}var u={name:"ChatBody",data(){return{customerName:"",customerImg:"",Msg:"",ActiveName:"SmartReply",AnswerTitle:"",AnswerText:"",TransferValue:"",TransferOptions:[],TransferPopover:!1}},computed:{customerId(){return this.Msg="",this.customerName=this.$store.state.currentCustomer.customer_nick_name,this.customerImg=this.$store.state.currentCustomer.customer_head_img_url,this.$store.state.currentCustomer.customer_id},ContactItem(){let t=this.$store.state.currentRoomMessages;return this.AnswerTitle=t[t.length-1].msg,this.AnswerText=t[t.length-1].ai_msg,t}},methods:{clearStatus(){this.Msg="",this.AnswerTitle="",this.AnswerText=""},sendMesage(t){if(t.ctrlKey)return void(this.Msg+="\n");let e=this.Msg;this.clearStatus(),e&&0!==e.replace(/\n/g,"").replace(/\s/g,"").length?this.axios.post("/admin/dialog",{msg_type:"text",customer_id:this.customerId,msg:e}).then(t=>{this.ContactItem.push({create_time:c(new Date,"yyyy-MM-dd hh:mm:ss"),msg:e,oper_code:2003})},t=>{this.$message.error("发送失败，微信限制给固定用户发送的频率和时间，需要等待用户再次主动发起聊天才能够发送"),console.log(t)}):this.$message.error("不能发送空的内容")},TransferShow(){this.axios.get("admin/kf/online").then(t=>{this.TransferOptions=t.data})},Transfer(){let t=this.TransferValue,e=this.customerId;this.axios.post("/admin/room/transfer",{customer_id:e,transfer_kf_id:t}).then(t=>{this.TransferValue="",this.TransferPopover=!1,this.$store.commit("transferRoom",this.customerId),this.$store.commit("cleanCurrentCustomer"),this.$notify.success({title:"客户转接",message:"转接成功"})})}},updated:function(){var t=document.getElementById("ChatWindow");t&&(t.scrollTop=t.scrollHeight)}},d=u,p=(s("1a9a"),s("2877")),h=Object(p["a"])(d,r,l,!1,null,"feb7f2a8",null),g=h.exports,f={name:"ReplyPanel",components:{ChatBody:g},data(){return{CustomerId:""}},computed:{ContactsItems(){return this.$store.state.roomData}},methods:{openChatBody:function(t){this.CustomerId=t.customer_id,this.$store.commit("setCurrentCustomer",t),this.axios.put("/admin/dialog/ack",{customer_ids:[t.customer_id]}),this.$store.commit("setWaitAck",t.customer_id)}}},C=f,_=(s("f1af"),Object(p["a"])(C,n,o,!1,null,"2c2cb78a",null)),b=_.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"AccessMain",attrs:{id:"AccessMain"}},[a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{size:"small",type:"info",plain:""},on:{click:t.toggleAllSelection}},[t._v("全选/取消选择")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(e){return t.handleClick()}}},[t._v("接入选中客户")])],1),a("el-table",{ref:"dTable",staticStyle:{width:"100%"},attrs:{data:t.AccessList,stripe:"",size:"medium"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{type:"index",index:t.indexMethod}}),a("el-table-column",{attrs:{prop:"customer_nick_name",label:"用户昵称",width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.customer_head_img_url?a("img",{staticClass:"touxiang",attrs:{src:e.row.customer_head_img_url,alt:"img"}}):a("img",{staticClass:"touxiang",attrs:{alt:"img",src:s("9d64")}}),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.customer_nick_name))])]}}])}),a("el-table-column",{attrs:{prop:"create_time",label:"日期",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-time"}),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.create_time.substring(0,19).replace("T"," ")))])]}}])}),a("el-table-column",{attrs:{prop:"msg",label:"消息",width:"400","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return t.handleClick(e.row)}}},[t._v("接入\n                ")])]}}])})],1)],1)},w=[],k={name:"AccessPanel",data(){return{indexMethod:1,multipleSelection:[]}},computed:{AccessList(){let t=[];return this.$store.state.waitData.forEach(e=>{t.push({customer_id:e.room_customer.customer_id,customer_nick_name:e.room_customer.customer_nick_name,customer_head_img_url:e.room_customer.customer_head_img_url,msg:e.room_messages[0].msg,create_time:e.room_messages[0].create_time})}),t}},methods:{handleSelectionChange(t){this.multipleSelection=t},toggleAllSelection(){this.$refs.dTable.toggleAllSelection()},handleClick(t){if(t)this.accessCustomer([t.customer_id]);else{let t=[];this.multipleSelection.forEach(e=>{t.push(e.customer_id)}),this.accessCustomer(t)}},accessCustomer(t){this.axios.post("/admin/wait_queue/access",{customer_ids:t}).then(e=>{this.$store.commit("cleanWaitData",t)})}}},y=k,A=Object(p["a"])(y,v,w,!1,null,"370e43e3",null),T=A.exports,x=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-row",{staticClass:"AccessMain",attrs:{id:"AccessMain"}},[s("div",{staticStyle:{"margin-top":"20px"}},[s("el-button",{attrs:{type:"primary",size:"small",loading:t.loading,plain:""},on:{click:t.search}},[t._v("查询")]),s("el-date-picker",{staticStyle:{"margin-left":"10px"},attrs:{"picker-options":t.pickerOptions,size:"small",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.pickerValue,callback:function(e){t.pickerValue=e},expression:"pickerValue"}})],1),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"dTable",staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.8)",height:"570",data:t.tableData,stripe:"","show-summary":"",size:"medium"}},[s("el-table-column",{attrs:{type:"index"}}),s("el-table-column",{attrs:{prop:"JobNum",label:"工号",width:"180"}}),s("el-table-column",{attrs:{prop:"NickName",label:"姓名"}}),s("el-table-column",{attrs:{prop:"GroupName",label:"组名",filters:[{text:"咨询组",value:"咨询组"},{text:"投诉组",value:"投诉组"}],"filter-method":t.filterTag,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-tag",{attrs:{type:"投诉组"===e.row.GroupName?"primary":"success","disable-transitions":""}},[t._v(t._s(e.row.GroupName)+"\n                ")])]}}])}),s("el-table-column",{attrs:{prop:"SendCount",sortable:"",label:"发送消息总量"}}),s("el-table-column",{attrs:{prop:"ReceptionCount",sortable:"",label:"服务客户总量"}})],1)],1)},I=[],S={name:"StatisticsPanel",data(){return{loading:!1,pickerValue:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick(t){const e=new Date,s=new Date;s.setTime(s.getTime()-6048e5),t.$emit("pick",[s,e])}},{text:"最近一个月",onClick(t){const e=new Date,s=new Date;s.setTime(s.getTime()-2592e6),t.$emit("pick",[s,e])}},{text:"最近三个月",onClick(t){const e=new Date,s=new Date;s.setTime(s.getTime()-7776e6),t.$emit("pick",[s,e])}}]},tableData:[]}},methods:{filterTag(t,e){return e.GroupName===t},search(){2===this.pickerValue.length?(this.loading=!0,this.axios.post("/admin/statistics/",{StartTime:this.pickerValue[0],EndTime:this.pickerValue[1]}).then(t=>{this.tableData=t.data}).finally(()=>{this.loading=!1})):this.$message.error("查询时间不正确")}}},M=S,D=Object(p["a"])(M,x,I,!1,null,"cda3e348",null),R=D.exports,N={components:{AccessPanel:T,ReplyPanel:b,StatisticsPanel:R},data(){return{currentTab:"ReplyPanel",wsHeartBeat:null,isOnline:!1}},computed:{currentTabComputed(){return this.currentTab},replyNum(){return this.$store.state.roomData.filter(t=>2002===t.room_messages[t.room_messages.length-1].oper_code&&!1===t.room_messages[t.room_messages.length-1].ack).length},accessNum(){return this.$store.state.waitData.length}},methods:{initWSocket(){let t=`${this.axios.wsHost}/admin/ws?token=${encodeURIComponent(this.$cookies.get("token"))}`;var e=function(e){var s=new WebSocket(t);return s.onopen=function(t){e.$notify.success({title:"WS协议连接成功",message:`【${e.$cookies.get("group_name")}】客服代表【${e.$cookies.get("nick_name")}】欢迎登录`}),e.isOnline=!0},s.onmessage=function(t){e.isOnline=!0;let s=JSON.parse(t.data);switch(s.Type){case 0:break;case 1:e.axios.get(`/admin/room/${s.Body}`).then(t=>{let s=t.data;s.room_kf.kf_id?(console.log("新消息",s),e.$store.commit("updateRoomData",s)):(console.log("待接入用户",s),e.$store.commit("updateWaitData",s))});break;case 2:console.log("收到广播",s.Body),e.$store.commit("cleanWaitData",[s.Body]);break;default:console.log("未知的Socket指令",s);break}},s.onclose=function(t){e.$notify.error({title:"WS连接异常",message:"服务器已断开连接，正在尝试重连"}),e.isOnline=!1},s};this.$store.commit("initwSocket",e(this)),this.wsHeartBeat=setInterval(()=>{let t=this.$store.state.wSocket;switch(t.readyState){case 0:break;case 1:this.$store.state.wSocket.send("+");break;case 3:this.$store.commit("cleanwSocket"),this.$store.commit("initwSocket",e(this));break}},5e3)},loginOut(){this.$cookies.remove("token"),this.$notify.success({title:"安全退出",message:"\n                        您已经安全退出！"}),this.$router.push("/login")}},created(){this.$notify.info({title:"连接服务器",message:"数据初始化中..."}),this.initWSocket(),this.axios.get("/admin/init").then(t=>{this.$store.commit("setRoomData",t.data.online_customer),this.$store.commit("setWaitData",t.data.wait_customer)})},destroyed(){clearInterval(this.wsHeartBeat)}},O=N,B=(s("a56d"),Object(p["a"])(O,a,i,!1,null,"6bfb8e6c",null));e["default"]=B.exports},d77c:function(t,e,s){},f1af:function(t,e,s){"use strict";var a=s("75f8"),i=s.n(a);i.a}}]);
//# sourceMappingURL=chunk-6d16f8e3.a3e75a30.js.map